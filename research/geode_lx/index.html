
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://pcengines.github.io/apu2-documentation/research/geode_lx/">
      
      
        <link rel="prev" href="../freebsd_tpm_support/">
      
      
        <link rel="next" href="../Orange_Pi_flasher/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.5">
    
    
      
        <title>Geode lx - apu2 Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#alix-and-amd-geode-lx" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="apu2 Documentation" class="md-header__button md-logo" aria-label="apu2 Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            apu2 Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Geode lx
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="apu2 Documentation" class="md-nav__button md-logo" aria-label="apu2 Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    apu2 Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu_CPU_boost/" class="md-nav__link">
        apu CPU boost
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu_ecc/" class="md-nav__link">
        Apu ecc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu_flashing_ipxe/" class="md-nav__link">
        Apu flashing ipxe
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu_flashing_with_rpi/" class="md-nav__link">
        Apu flashing with rpi
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../APU_mPCIe_capabilities/" class="md-nav__link">
        APU mPCIe capabilities
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu2_vboot/" class="md-nav__link">
        Apu2 vboot
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu2_vs_apu3/" class="md-nav__link">
        Apu2 vs apu3
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../apu2_vs_apu4/" class="md-nav__link">
        Apu2 vs apu4
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cbmem_building/" class="md-nav__link">
        Cbmem building
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cold_reset/" class="md-nav__link">
        Performing cold reset remotely
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../firmware_flashing/" class="md-nav__link">
        Firmware flashing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../flashrom_building/" class="md-nav__link">
        Flashrom building
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../generating_coreboot_support_logs/" class="md-nav__link">
        Generating coreboot support logs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../gpios/" class="md-nav__link">
        Gpios
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../ipxe_compile/" class="md-nav__link">
        Ipxe compile
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../linux_issues/" class="md-nav__link">
        Linux issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../microcode_patching/" class="md-nav__link">
        Microcode patching
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../mpcie_modules/" class="md-nav__link">
        Mpcie modules
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../order_of_PCI_addresses/" class="md-nav__link">
        order of PCI addresses
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../os_boot_serial_console/" class="md-nav__link">
        Os boot serial console
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../os-status/" class="md-nav__link">
        Os status
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../pfsense_installerconfig/" class="md-nav__link">
        Pfsense installerconfig
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../pfSense-install-guide/" class="md-nav__link">
        pfSense install guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../pxelinux-cfg/" class="md-nav__link">
        Pxelinux cfg
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../release_process/" class="md-nav__link">
        Release process
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../sd_card_performance_test/" class="md-nav__link">
        Sd card performance test
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../serial_console/" class="md-nav__link">
        Serial console
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../supported_coreboot_build/" class="md-nav__link">
        Supported coreboot build
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../theory-of-operation/" class="md-nav__link">
        apu features - theory of operation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tianocore_build/" class="md-nav__link">
        Tianocore build
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tpm_menu/" class="md-nav__link">
        Tpm menu
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tpm_pin_mapping/" class="md-nav__link">
        Pin mapping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../voyage_image_building_alix/" class="md-nav__link">
        Voyage image building alix
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../voyage_linux_netinst/" class="md-nav__link">
        Configuring Voyage Linux netinst
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../voyage_linux_sd_card_install/" class="md-nav__link">
        Voyage linux sd card install
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../power_consumption_testing/" class="md-nav__link">
        Power Consumption Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_37" type="checkbox" id="__nav_37" >
      
      
      
        <label class="md-nav__link" for="__nav_37" tabindex="0" aria-expanded="false">
          debug
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="debug" data-md-level="1">
        <label class="md-nav__title" for="__nav_37">
          <span class="md-nav__icon md-icon"></span>
          debug
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/AGESA/" class="md-nav__link">
        AGESA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/alix3d2_issue/" class="md-nav__link">
        Alix3d2 issue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/cpu_frequency/" class="md-nav__link">
        Debug notes for CPU frequency issues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/debian_kernel_rebuild/" class="md-nav__link">
        Debian kernel rebuild
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/external_sd_slot/" class="md-nav__link">
        External sd slot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/freeDOS_problems/" class="md-nav__link">
        freeDOS problems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/hdd_mPCIe_log_analyze/" class="md-nav__link">
        hdd mPCIe log analyze
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/hdd_test/" class="md-nav__link">
        Hdd test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/iommu/" class="md-nav__link">
        Iommu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/mpcie_ethernet/" class="md-nav__link">
        Mpcie ethernet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/mpcie1_mpcie2_ethernet_card/" class="md-nav__link">
        Mpcie1 mpcie2 ethernet card
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/mpcie2/" class="md-nav__link">
        Mpcie2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/openwrt/" class="md-nav__link">
        Openwrt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/pfsense-ahci-issue/" class="md-nav__link">
        Pfsense ahci issue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/sd_registers_bad/" class="md-nav__link">
        Sd registers bad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/sdcard_debug/" class="md-nav__link">
        Sdcard debug
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/sdcard_test/" class="md-nav__link">
        Sdcard test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/tplink_hg/" class="md-nav__link">
        Tplink hg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/tpm/" class="md-nav__link">
        Tpm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/usb-debugging/" class="md-nav__link">
        apu2 USB xHCi debugging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/usb-sticks/" class="md-nav__link">
        Usb sticks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/usb-tests/" class="md-nav__link">
        Usb tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debug/warmboot_reset/" class="md-nav__link">
        Warmboot reset
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_38" type="checkbox" id="__nav_38" checked>
      
      
      
        <label class="md-nav__link" for="__nav_38" tabindex="0" aria-expanded="true">
          research
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="research" data-md-level="1">
        <label class="md-nav__title" for="__nav_38">
          <span class="md-nav__icon md-icon"></span>
          research
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apu_bios_write_protect/" class="md-nav__link">
        Apu bios write protect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../early-cbmem-implementation/" class="md-nav__link">
        Early cbmem implementation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fast_boot/" class="md-nav__link">
        Fast boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../freebsd_tpm_support/" class="md-nav__link">
        Freebsd tpm support
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Geode lx
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Geode lx
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-abbreviations" class="md-nav__link">
    List of abbreviations
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Orange_Pi_flasher/" class="md-nav__link">
        Orange Pi flasher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../power-consumption-tests/" class="md-nav__link">
        PC Engines apu3 power consumption tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ROCA/" class="md-nav__link">
        ROCA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../RPI_SPI_flasher/" class="md-nav__link">
        RPI flasher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tpm2-triage/" class="md-nav__link">
        Tpm2 triage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../USB_compliance_test/" class="md-nav__link">
        USB compliance tests
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-abbreviations" class="md-nav__link">
    List of abbreviations
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="alix-and-amd-geode-lx">ALIX and AMD Geode LX</h1>
<p>This paper contains research about Geode LX CAR and whole effort to implement
<code>EARLY_CBMEM_INIT</code> in coreboot for PC Engines ALIX platforms.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#list-of-abbreviations">List of abbreviations</a></li>
<li><a href="#memory-initialisation">Memory initialisation</a><ul>
<li><a href="#memory-types-and-caching-policies">Memory types and caching policies</a></li>
<li><a href="#mtrrs">MTRRS</a><ul>
<li><a href="#fixed-mtrrs">Fixed MTRRs</a></li>
<li><a href="#variable-mtrrs">Variable MTRRs</a></li>
<li><a href="#geode-lx-mtrrs">Geode LX MTRRs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="list-of-abbreviations">List of abbreviations</h2>
<ul>
<li><code>SDM</code> - Software Developer Manual</li>
<li><code>MTRR</code> - Memory Type Range Register</li>
<li><code>MSR</code> - Model Specific Register</li>
<li><code>CAR</code> - Cache-as-RAM</li>
<li><code>UC</code> - Strong Uncacheable</li>
<li><code>UC-</code> - Uncacheable</li>
<li><code>WC</code> - Write Combining</li>
<li><code>WT</code> - Write Through</li>
<li><code>WB</code> - Write Back</li>
<li><code>WP</code> - Write Protected</li>
<li><code>SMM</code> - System Management Mode</li>
<li><code>DMM</code> - Debug Management Mode</li>
</ul>
<h1 id="memory-initialisation">Memory initialisation</h1>
<p>Current ALIX platforms support in coreboot (state at the day of writing this
document) lets user build a firmware capable to boot the platform without
issues. However... With coreboot 4.7 version, new standards has been introduced
which every platform must meet to be supported (to stay in the main branch). One
of these standards (requirements) is <code>EARLY_CBMEM_INIT</code> to be used by platform.
<code>EARLY_CBMEM_INIT</code> allows to save log to cbmem early in romstage, but that's not
all about it. To get all benefits of <code>EARLY_CBMEM_INIT</code>, the main memory need to
be initialised and addressable in romstage. Unfortunately ALIX platforms
initialize memory in ramstage, which breaks the model proposed by coreboot
project.</p>
<p>In order to achieve the goal (move platform to <code>EARLY_CBMEM_INIT</code>), deeper
understading of caching, memory initialisation and CAR is needed. Below
sections describes steps needed to reach the goal.</p>
<h2 id="memory-types-and-caching-policies">Memory types and caching policies</h2>
<p>Intel SDM is a good source of knowledge about caching and memory types.
Detialed description is available in Intel SDM vol 3A Section 11.3.</p>
<p>In brief Intel describes 6 memory types which are used in Intel's hardware:</p>
<ul>
<li><code>UC</code> - System memory locations are not cached. All reads and writes appear on
  the system bus and are executed in program order without reordering.</li>
<li><code>UC-</code> - Has same characteristics as the strong uncacheable (UC) memory type,
  except that this memory type can be overridden by programming the MTRRs for
  the WC memory type</li>
<li><code>WC</code> - System memory locations are not cached (as with uncacheable memory) and
  coherency is not enforced by the processor’s bus coherency protocol.
  Speculative reads are allowed. Writes may be delayed and combined in the write
  combining buffer (WC buffer) to reduce memory accesses. If the WC buffer is
  partially filled, the writes may be delayed until the next occurrence of a
  serializing event</li>
<li><code>WT</code> - Writes and reads to and from system memory are cached. Reads come from
  cache lines on cache hits; read misses cause cache fills. Speculative reads
  are allowed. All writes are written to a cache line (when possible) and
  through to system memory. When writing through to memory, invalid cache lines
  are never filled, and valid cache lines are either filled or invalidated.
  Write combining is allowed.</li>
<li><code>WB</code> - Writes and reads to and from system memory are cached. Reads come from
  cache lines on cache hits; read misses cause cache fills. Speculative reads
  are allowed. Write misses cause cache line fills, and writes are performed
  entirely in the cache, when possible. Write combining is allowed. The
  write-back memory type reduces bus traffic by eliminating many unnecessary
  writes to system memory. Writes to a cache line are not immediately forwarded
  to system memory; instead, they are accumulated in the cache. The modified
  cache lines are written to system memory later, when a write-back operation
  is performed.</li>
<li><code>WP</code> - Reads come from cache lines when possible, and read misses cause cache
  fills. Writes are propagated to the system bus and cause corresponding cache
  lines on all processors on the bus to be invalidated. Speculative reads are
  allowed.</li>
</ul>
<p>Section 11.2 describes the terms <code>cache line fill</code>, <code>cache hit</code> and <code>write hit</code>.</p>
<h2 id="mtrrs">MTRRS</h2>
<p>MTRRs are registers responsible for setting memory type for given address ranges
of physical memory. They are divided into two groups:</p>
<ul>
<li>fixed MTRRs</li>
<li>variable MTRRs</li>
</ul>
<p>MTRR availability if identified by bit 12 in EDX register after issuing CPUID
instruction. Additional information about MTRRs are stored in <code>IA32_MTRRCAP</code> MSR
which is read-only. It defines variable MTRRs count, fixed MTRRs count etc.</p>
<p>All MTRRs and <code>IA32_MTRRCAP</code> are described in Section 11.11 in Intel SDM vol 3A
and subsequent subsections.</p>
<h3 id="fixed-mtrrs">Fixed MTRRs</h3>
<p>Fixed MTRR allows to set memory type for region handled by corresponding MTRR.
There are 3 types of fixed MTRRs based on address range covered:</p>
<ul>
<li>Register <code>IA32_MTRR_FIX64K_00000</code> — Maps the 512-KByte address range from 0H
  to 7FFFFH. This range is divided into eight 64-KByte sub-ranges</li>
<li>Registers <code>IA32_MTRR_FIX16K_80000</code> and <code>IA32_MTRR_FIX16K_A0000</code> — Maps the two
  128-KByte address ranges from 80000H to BFFFFH. This range is divided into
  sixteen 16-KByte sub-ranges, 8 ranges per register.</li>
<li>Registers <code>IA32_MTRR_FIX4K_C0000</code> through <code>IA32_MTRR_FIX4K_F8000</code> — Maps eight
  32-KByte address ranges from C0000H to FFFFFH. This range is divided into
  sixty-four 4-KByte sub-ranges, 8 ranges per register.</li>
</ul>
<p>These registers can set memory type only for a <code>fixed</code> address range.</p>
<h3 id="variable-mtrrs">Variable MTRRs</h3>
<p><code>IA32_MTRRCAP</code> MSR contains number of variable ranges supported by CPU (this
number is also an upper limit of variable MTRRs). These MTRRs allow to define
not only memory type, but also the address range it will be applied to.</p>
<p>The range is defined by programming BASE and MASK registers.</p>
<blockquote>
<p>NOTE: all MTRRS must be consistent across all CPUs in multi-processor systems.</p>
</blockquote>
<h3 id="geode-lx-mtrrs">Geode LX MTRRs</h3>
<p>Geode LX registers does not have typical MTRRs as described in Intel SDM.
Do not be surprised, it is quite old processor and created by AMD. It is
obvious that registers will differ. However there is a set of MSRs which
serve the same purpose as MTRRs.</p>
<p>The equivalents of fixed MTRRs are described below.</p>
<ul>
<li><code>RCONF_A0_BF_MSR</code> - is a regions configuration register for address range
  between 0xA0000 and 0xBFFFF (128 KByte). This range is divided into eight
  16-KByte sub-ranges. Equivalent of <code>IA32_MTRR_FIX16K_A0000</code></li>
<li><code>RCONF_C0_DF_MSR</code> - same as above for range 0xC0000 and 0xDFFFF (128 KByte).
  There is no equivalent in Intel SDM (Intel's implementation for range
  0xC0000 - 0xDFFFF is programmed via <code>IA32_MTRR_FIX4K_xxxxx</code> which are 32=KByte
  address range registers with eight 4-Kbyte subranges)</li>
<li><code>RCONF_E0_FF_MSR</code> - same as above for range 0xE0000 and 0xFFFFF (128 KByte).
  No equivalents, this range is covered by <code>IA32_MTRR_FIX4K_xxxxx</code> registers in
  Intel's implementations.</li>
</ul>
<p>The equivalents of variable MTRRs are <code>RCONF0_MSR</code> through <code>RCONF7_MSR</code>. Eight
equivalents to Intel's variable MTRRs are available in Geode LX processor.
Fields defined by these registers: top of range, range base address,
enable/disable bit and 8 bits for region properties.</p>
<p>Additionally there are separate range register for SMM (<code>RCONF_SMM_MSR</code>) and DMM
(<code>RCONF_DMM_MSR</code>). They are defining SMM/DMM base address, top address,
enable/disable bit and region properties when region is active or inactive
(8 bits for each state).</p>
<p>Region properties are described in detail in Geode LX databook and seem to be
different than Intel's standard. Region properties are defined by 8 bits (64bit
MSR divided into eight sub-rnages, 8 bits for each subrange properties).</p>
<table>
<thead>
<tr>
<th>Bit</th>
<th>Property</th>
</tr>
</thead>
<tbody>
<tr>
<td>7</td>
<td>Reserved</td>
</tr>
<tr>
<td>6</td>
<td>Reserved</td>
</tr>
<tr>
<td>5</td>
<td><code>WS - Write-serialize</code></td>
</tr>
<tr>
<td>4</td>
<td><code>WC - Write-ombine</code></td>
</tr>
<tr>
<td>3</td>
<td><code>WT - Write-hrough</code></td>
</tr>
<tr>
<td>2</td>
<td><code>WP - Write-rotect</code></td>
</tr>
<tr>
<td>1</td>
<td><code>WA - Write-allocate</code></td>
</tr>
<tr>
<td>0</td>
<td><code>CD - Cache Disable</code></td>
</tr>
</tbody>
</table>
<p>Based on the setting, the properties can have different impact on read and write
operations. AMD's implementations allow to set multiple bits allowing to set
"memory subtypes" (page 170 of Geode LX databook):</p>
<table>
<thead>
<tr>
<th>Property Setting</th>
<th>Read Operation behaviour</th>
</tr>
</thead>
<tbody>
<tr>
<td>WS=0 and CD=0, rest don't care</td>
<td>Cacheable. Read misses cause a cache line to be allocated.</td>
</tr>
<tr>
<td>WS=1 and CD=0, rest don't care</td>
<td>Undefined State. Unpredictable behavior occurs.</td>
</tr>
<tr>
<td>CD=1, rest don't care</td>
<td>Uncacheable. Reads are sent unmodified to the bus. Equivalent to Intel's <code>UC</code> and <code>UC-</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="center">Property Setting</th>
<th align="left">Write Operation behaviour</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">WP=1, rest don't care</td>
<td align="left">Write-protected. Writes to the region are discarded. Equivalent to Intel's <code>WP</code></td>
</tr>
<tr>
<td align="center">WS=1, rest don't care</td>
<td align="left">Undefined. Unpredictable behavior occurs.</td>
</tr>
<tr>
<td align="center">WC=1 and CD=0, rest don't care</td>
<td align="left">Undefined. Unpredictable behavior occurs.</td>
</tr>
<tr>
<td align="center">WA=1 and CD=1, rest don't care</td>
<td align="left">Undefined. Unpredictable behavior occurs.</td>
</tr>
<tr>
<td align="center">00h</td>
<td align="left">Write-back Cacheable. Write misses are sent to the bus, a cache line is not allocated on a write miss.</td>
</tr>
<tr>
<td align="center">02h</td>
<td align="left">Write-back Cacheable/Write-allocate. Write misses allocate a line in the cache. Equivalent to Intel's <code>WB</code></td>
</tr>
<tr>
<td align="center">08h or 0Ah</td>
<td align="left">Write-through cacheable. Write misses do not allocate a line in the cache. Write hits update the cache but do not mark the line as dirty. All writes are sent to the bus. Similar to Intel's <code>WT</code></td>
</tr>
<tr>
<td align="center">01h</td>
<td align="left">Uncacheable. All writes are sent to the bus in strict program order without any combining. Write hits still update the cache. Equivalent to <code>UC</code> and <code>UC-</code></td>
</tr>
<tr>
<td align="center">21h</td>
<td align="left">Uncacheable as above. Additionally: Write-serialize. Limit the number of outstanding writes to the value of the WSREQ field in <code>DM_CONFIG0_MSR</code></td>
</tr>
<tr>
<td align="center">11h</td>
<td align="left">Write-combined (uncacheable). Writes to the same cache line may be combined. Multiple writes to the same byte results in a single write with the last value specified. Write order is not preserved. Similar to Intel's <code>WC</code></td>
</tr>
<tr>
<td align="center">31h</td>
<td align="left">Write-combined (uncacheable) as above. Additionally: <code>Write-serialize</code>. Limit the number of outstanding writes to the value of the WSREQ field in <code>DM_CONFIG0_MSR</code></td>
</tr>
<tr>
<td align="center">19h</td>
<td align="left">Write-burstable (uncacheable). Writes to the same cache line are combined as long as they are to increasing addresses and do not access a previously written byte. Multiple writes to the same byte results in multiple bytes on the bus.</td>
</tr>
<tr>
<td align="center">31h</td>
<td align="left">Write-burstable (uncacheable) as above. Additionally: <code>Write-serialize</code>. Limit the number of outstanding writes to the value of the WSREQ field in <code>DM_CONFIG0_MSR</code></td>
</tr>
</tbody>
</table>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>